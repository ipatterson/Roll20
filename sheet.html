<span class='style-wrapper'>
    <div class="top-grid">
        <span>
            <!-- Title? -->
        </span>
        <span>
            <div class="pageButtons">
                <button type="action" name="act_buildSheet">Build</button>
                <button type="action" name="act_weaponSheet">Weapons</button>
                <button type="action" name="act_armorSheet">Armor</button>
                <button type="action" name="act_inventorySheet">Inventory</button>
                <button type="action" name="act_skillSheet">Skills</button>
            </div>
        </span>
    </div>
    <span class="main-sheet">
        <div class="section-main">
            <!-- Column One -->
            <span class="main1">
                <input name="attr_tier_mod" type="hidden" value="0">
                <input type="hidden" value="0" name="attr_armorhp_mod" readonly>
                <input type="hidden" value="0" name="attr_armorap_mod" readonly>
                <h1>Level: <span name="attr_player_level"></span></h1>
                <input name="attr_player_level" type="hidden" value="0">
                <div class="stats-grid">
                    <span class="stat-box-hp">
                        <div class="stat-grid-hp">
                            <span class="text">HP</span>
                            <span class="curr"><input type="number" name="attr_hp"></span>
                            <span class="max">MAX:
                                <span name="attr_hp_max"></span>
                                <input type="hidden" name="attr_hp_max" readonly>
                            </span>
                        </div>
                    </span>
                    <span class="stat-box-mp">
                        <div class="stat-grid-mp">
                            <span class="text">MP</span>
                            <span class="curr"><input type="number" name="attr_mp"></span>
                            <span class="max">MAX:
                                <span name="attr_mp_max"></span>
                                <input type="hidden" name="attr_mp_max" readonly>
                            </span>
                        </div>
                    </span>
                    <span class="stat-box-ap">
                        <div class="stat-grid-ap">
                            <span class="text">AP</span>
                            <span class="curr"><input type="number" name="attr_ap"></span>
                            <span class="max">MAX:
                                <span name="attr_ap_max"></span>
                                <input type="hidden" name="attr_ap_max" readonly>
                            </span>
                        </div>
                    </span>
                </div>
                <h4>Equipment</h4>
                <span class='active-equipment'>
                    <input type="hidden" value="0" name="attr_eq_wpn_range" readonly>
                    <input type="hidden" value="0" name="attr_eq_wpn_block" readonly>
                    <input type="hidden" value="0" name="attr_eq_wpn_power" readonly>
                    <input type="hidden" value="None" name="attr_eq_wpn_source" readonly>
                    <input type="hidden" value="None" name="attr_eq_wpn_feature" readonly>
                    <input type="hidden" value="None" name="attr_eq_ar_name" readonly>
                    <input type="hidden" value="None" name="attr_eq_ar_weight" readonly>
                    <div class="eq-wpn-grid">
                        <span class="eq-wpn-grid-name">
                            <div class="lbl">WEAPON:</div>
                            <div class="val"><span name="attr_eq_wpn_name"></span>
                                <div>
                        </span>
                        <span class="eq-wpn-grid-source">
                            <div class="lbl">SOURCE:</div>
                            <div class="val"><span name="attr_eq_wpn_source"></span></div>
                        </span>
                        <span class="eq-wpn-grid-feature">
                            <div class="lbl">FEATURE:</div>
                            <div class="val"><span name="attr_eq_wpn_feature"></span></div>
                        </span>
                        <span class="eq-wpn-grid-arName">
                            <div class="lbl">ARMOR:</div>
                            <div class="val"><span name="attr_eq_ar_name"></span></div>
                        </span>
                        <span class="eq-wpn-grid-arWeight">
                            <div class="lbl">WEIGHT:</div>
                            <div class="val"><span name="attr_eq_ar_weight"></span></div>
                        </span>
                    </div>
                    <div class="eq-stats-grid">
                        <span class="eq-wpn-grid-power">
                            <div class="lbl">POWER:</div>
                            <div class="val"><span name="attr_eq_wpn_power"></span></div>
                        </span>
                        <span class="eq-wpn-grid-range">
                            <div class="lbl">RANGE:</div>
                            <div class="val"><span name="attr_eq_wpn_range"></span></div>
                        </span>
                        <span class="eq-wpn-grid-block">
                            <div class="lbl">BLOCK:</div>
                            <div class="val"><span name="attr_eq_wpn_block"></span></div>
                        </span>
                    </div>
                </span>
                <h4>Attributes & Actions</h4>
                <div class="modifier-inst"><span class="modifier-note">NOTE:</span> Rolls take into account modifier fields. Hit 'Enter' to apply modifier number changes!</div>
                <div class="attribute-grid-title">
                    <input type="hidden" value="3d20>8" name="attr_stat_base_dice_roll" readonly>
                    <input type="hidden" value="*" name="attr_stat_roll_operator" readonly>
                    <input type="hidden" value="Success-Based" name="attr_stat_roll_type" readonly>
                    <input type="hidden" value="0" name="attr_stat_roll_power_formula" readonly>
                    <input type="hidden" value="0" name="attr_stat_roll_dice_mod_ready" readonly>
                    <input type="hidden" value="0" name="attr_stat_roll_power_mod_ready" readonly>
                    <input type="hidden" value="&{template:default}" name="attr_stat_roll_template" readonly>
                    <div class="attribute-grid-title-text">ATTRIBUTE ROLLER</div>
                    <div class="modifier-grid">
                        <div class='dice-mod-input'>
                            Dice: <input type="number" placeholder="0" name="attr_stat_roll_dice_mod">
                            <span style="font-family: 'Pictos'">]</span>
                            <span name="attr_stat_roll_dice_mod_ready" class='lbl-mod'></span>
                        </div>
                        <div class='power-mod-input'>
                            Power: <input type="number" placeholder="0" name="attr_stat_roll_power_mod">
                            <span style="font-family: 'Pictos'">]</span>
                            <span name="attr_stat_roll_power_mod_ready" class='lbl-mod'></span>
                        </div>
                    </div>
                    <div class='attribute-grid'>
                        <input class="radio-ability" type="radio" id="radio-ability" name="attr_stat_roller_toggle" value="ability">
                        <label for="radio-ability" class="lbl-radio-ability">
                            <div class='help-text-attb'>
                                <span style="font-family: 'Pictos'">S</span>
                                <span class='tooltip'>Perform an additive attribute check</span>
                            </div>
                        </label>
                        <input class="radio-attack" type="radio" id="radio-attack" name="attr_stat_roller_toggle" value="attack" checked>
                        <label for="radio-attack" class="lbl-radio-attack">
                            <div class='help-text-attb' style="width: 35px">
                                <span style="font-family: 'Pictos'">e</span>
                                <span class='tooltip'>Perform a success-based attribute check</span>
                            </div>
                        </label>
                        <button class="btn-attr attribImpact" type="roll" name="roll_impact-check" value="!statroll --statName Impact --statValue @{impact} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Impact
                            <br /><span name="attr_impact" class='attribNum'></span></button>
                        <input name="attr_impact" type="hidden" value="2">
                        <button class="btn-attr attribResist" type="roll" name="roll_resist-check" value="!statroll --statName Resist --statValue @{resist} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Resist
                            <br /><span name="attr_resist" class='attribNum'></span></button>
                        <input name="attr_resist" type="hidden" value="2">
                        <button class="btn-attr attribEnergy" type="roll" name="roll_energy-check" value="!statroll --statName Energy --statValue @{energy} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Energy
                            <br /><span name="attr_energy" class='attribNum'></span></button>
                        <input name="attr_energy" type="hidden" value="2">
                        <button class="btn-attr attribBrawn" type="roll" name="roll_brawn-check" value="!statroll --statName Brawn --statValue @{brawn} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Brawn
                            <br /><span name="attr_brawn" class='attribNum'></span></button>
                        <input name="attr_brawn" type="hidden" value="2">
                        <button class="btn-attr attribMight" type="roll" name="roll_might-check" value="!statroll --statName Might --statValue @{might} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Might
                            <br /><span name="attr_might" class='attribNum'></span></button>
                        <input name="attr_might" type="hidden" value="4">
                        <button class="btn-attr attribBody" type="roll" name="roll_body-check" value="!statroll --statName Body --statValue @{body} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Body
                            <br /><span name="attr_body" class='attribNum'></span></button>
                        <input name="attr_body" type="hidden" value="4">
                        <button class="btn-attr attribVigor" type="roll" name="roll_vigor-check" value="!statroll --statName Vigor --statValue @{vigor} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Vigor
                            <br /><span name="attr_vigor" class='attribNum'></span></button>
                        <input name="attr_vigor" type="hidden" value="4">
                        <button class="btn-attr attribMagic" type="roll" name="roll_magic-check" value="!statroll --statName Magic --statValue @{magic} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Magic
                            <br /><span name="attr_magic" class='attribNum'></span></button>
                        <input name="attr_magic" type="hidden" value="2">
                        <button class="btn-attr attribWill" type="roll" name="roll_will-check" value="!statroll --statName Will --statValue @{will} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Will
                            <br /><span name="attr_will" class='attribNum'></span></button>
                        <input name="attr_will" type="hidden" value="4">
                        <button class="btn-attr attribEgo" type="roll" name="roll_ego-check" value="!statroll --statName Ego --statValue @{ego} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Ego
                            <br /><span name="attr_ego" class='attribNum'></span></button>
                        <input name="attr_ego" type="hidden" value="4">
                        <button class="btn-attr attribEssence" type="roll" name="roll_essen-check" value="!statroll --statName Essence --statValue @{essence} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Essence
                            <br /><span name="attr_essence" class='attribNum'></span></button>
                        <input name="attr_essence" type="hidden" value="4">
                        <button class="btn-attr attribMastery" type="roll" name="roll_mastery-check" value="!statroll --statName Mastery --statValue @{mastery} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Mastery
                            <br /><span name="attr_mastery" class='attribNum'></span></button>
                        <input name="attr_mastery" type="hidden" value="2">
                        <button class="btn-attr attribTechnique" type="roll" name="roll_tech-check" value="!statroll --statName Technique --statValue @{technique} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Tech
                            <br /><span name="attr_technique" class='attribNum'></span></button>
                        <input name="attr_technique" type="hidden" value="4">
                        <button class="btn-attr attribInstinct" type="roll" name="roll_inst-check" value="!statroll --statName Instinct --statValue @{instinct} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Instinct
                            <br /><span name="attr_instinct" class='attribNum'></span></button>
                        <input name="attr_instinct" type="hidden" value="4">
                        <button class="btn-attr attribFocus" type="roll" name="roll_focus-check" value="!statroll --statName Focus --statValue @{focus} --toggle @{stat_roller_toggle} --tier @{tier_mod} --diceMod @{stat_roll_dice_mod_ready} --powerMod @{stat_roll_power_mod_ready}">Focus
                            <br /><span name="attr_focus" class='attribNum'></span></button>
                        <input name="attr_focus" type="hidden" value="4">
                    </div>
                </div>
                <div class="attack-grid-title">
                    <input type="hidden" value="3d20>8" name="attr_atk_base_dice_roll" readonly>
                    <input type="hidden" value="&{template:attack}" name="attr_atk_roll_template" readonly>
                    <input type="hidden" value="1" name="attr_atk_roll_tier" readonly>
                    <div class="attack-grid-title-text">ATTACK ROLLER</div>
                    <div class="modifier-grid">
                        <div class='dice-mod-input'>
                            Dice: <input type="number" placeholder="0" name="attr_atk_roll_dice_mod">
                            <span style="font-family: 'Pictos'">]</span>
                            <span name="attr_atk_roll_dice_mod_ready" class='lbl-mod'></span>
                        </div>
                        <div class='power-mod-input'>
                            Power: <input type="number" placeholder="0" name="attr_atk_roll_power_mod">
                            <span style="font-family: 'Pictos'">]</span>
                            <span name="attr_atk_roll_power_mod_ready" class='lbl-mod'></span>
                        </div>
                    </div>
                    <div class="action-grid">
                        <button class="btn-attack" type="roll" value="!attack --wpnPower @{eq_wpn_power} --tier @{tier_mod} --diceMod @{atk_roll_dice_mod_ready} --powerMod @{atk_roll_power_mod_ready}" name="roll_wpnAttack"><b>&nbsp;&nbsp;ATTACK WITH<br />EQUIPPED WEAPON</b></button>
                        <button class="btn-charge">[CHARGE ACTION]</button>
                        <button class="btn-defend">[DEFEND ACTION]</button>
                        <button class="btn-steady" type="roll" value="!steady 1'">[STEADY ACTION]</button>
                    </div>
                </div>
            </span>
            <!-- Column Two -->
            <span class="section-tabs">
                <input type='hidden' class='tabstoggle' name='attr_sheetTab' value='armorSheet'>
                <!------------------------ BUILD -------------------------------------->
                <div class="buildSheet">
                    <h1>Roles & Traits</h1>
                    <div class='rolegrid'>
                        <span class='role1'>
                            <h4>Role 1</h4>
                            <span class='select-new-arrow'><select name="attr_role1" class="role">
                                    <option value="def" selected="selected">Select</option>
                                    <option value="blaster">Blaster</option>
                                    <option value="brute">Brute</option>
                                    <option value="defender">Defender</option>
                                    <option value="element">Element</option>
                                    <option value="healer">Healer</option>
                                    <option value="hex">Hex</option>
                                    <option value="kata">Kata</option>
                                    <option value="marksman">Marksman</option>
                                    <option value="proxy">Proxy</option>
                                    <option value="stealth">Stealth</option>
                                    <option value="striker">Striker</option>
                                    <option value="support">Support</option>
                                    <option value="tactician">Tactician</option>
                                    <option value="venom">Venom</option>
                                    <option value="veteran">Veteran</option>
                                    <option value="warden">Warden</option>
                                </select></span>
                            <br />
                            <input placeholder="Core Talent 1" type="text">
                        </span>
                        <span class='role2'>
                            <h4>Role 2</h4>
                            <span class='select-new-arrow'><select name="attr_role2" class="role">
                                    <option value="def" selected="selected">Select</option>
                                    <option value="blaster">Blaster</option>
                                    <option value="brute">Brute</option>
                                    <option value="defender">Defender</option>
                                    <option value="element">Element</option>
                                    <option value="healer">Healer</option>
                                    <option value="hex">Hex</option>
                                    <option value="kata">Kata</option>
                                    <option value="marksman">Marksman</option>
                                    <option value="proxy">Proxy</option>
                                    <option value="stealth">Stealth</option>
                                    <option value="striker">Striker</option>
                                    <option value="support">Support</option>
                                    <option value="tactician">Tactician</option>
                                    <option value="venom">Venom</option>
                                    <option value="veteran">Veteran</option>
                                    <option value="warden">Warden</option>
                                </select></span>
                            <br />
                            <input placeholder="Core Talent 2" type="text">
                        </span>
                        <span class='role3'>
                            <h4>Role 3</h4>
                            <span class='select-new-arrow'><select name="attr_role3" class="role">
                                    <option value="def" selected="selected">Select</option>
                                    <option value="blaster">Blaster</option>
                                    <option value="brute">Brute</option>
                                    <option value="defender">Defender</option>
                                    <option value="element">Element</option>
                                    <option value="healer">Healer</option>
                                    <option value="hex">Hex</option>
                                    <option value="kata">Kata</option>
                                    <option value="marksman">Marksman</option>
                                    <option value="proxy">Proxy</option>
                                    <option value="stealth">Stealth</option>
                                    <option value="striker">Striker</option>
                                    <option value="support">Support</option>
                                    <option value="tactician">Tactician</option>
                                    <option value="venom">Venom</option>
                                    <option value="veteran">Veteran</option>
                                    <option value="warden">Warden</option>
                                </select></span>
                            <br />
                            <input placeholder="Core Talent 3" type="text">
                        </span>
                    </div>
                    <hr>
                    <h1> Starting Traits </h1>
                    <div class="base-stat-grid">
                        <span class="base-stat1select">
                            <span class='select-new-arrow'><select name="attr_start-stat1">
                                    <option value="def" selected="selected">Select</option>
                                    <option value="brawn">Brawn</option>
                                    <option value="magic">Magic</option>
                                    <option value="mastery">Mastery</option>
                                </select></span>
                        </span>
                        <span class="base-stat2select">
                            <span class='select-new-arrow'><select name="attr_start-stat2">
                                    <option value="def" selected="selected">Select</option>
                                    <option value="impact">Impact</option>
                                    <option value="resist">Resist</option>
                                    <option value="energy">Energy</option>
                                </select></span>
                        </span>
                    </div>
                    <hr>
                    <input type='hidden' class='tier_tabstoggle' name='attr_tierTab' value='tier1tab'>
                    <div class="tier-button-grid">
                        <span class="tier1button">
                            <button type="action" name="act_tier1tab">Tier 1</button>
                        </span>
                        <span class="tier2button">
                            <button type="action" name="act_tier2tab">Tier 2</button>
                        </span>
                        <span class="tier3button">
                            <button type="action" name="act_tier3tab">Tier 3</button>
                        </span>
                    </div>
                    <div class="tier1tab">
                        <h1>Tier 1</h1>
                        <div class='tier-grid'>
                            <!-- Row 1, Columns 1-6 -->
                            <!-- Tier 1, Role 1, Trait 1 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role1trait1">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 1, Role 2, Trait 1 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role2trait1">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 1, Role 3, Trait 1 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role3trait1">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Row 2, Columns 1-6 -->
                            <!-- Tier 1, Role 1, Trait 2 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role1trait2">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 1, Role 2, Trait 2 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role2trait2">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 1, Role 3, Trait 2 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role3trait2">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Row 3, Columns 1-6 -->
                            <!-- Tier 1, Role 1, Trait 3 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role1trait3">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 1, Role 2, Trait 3 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role2trait3">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 1, Role 3, Trait 3 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role3trait3">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="trait_Brawn">Brawn</option>
                                        <option value="trait_Magic">Magic</option>
                                        <option value="trait_Mastery">Mastery</option>
                                        <option value="trait_Impact">Impact</option>
                                        <option value="trait_Resist">Resist</option>
                                        <option value="trait_Energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Row 4, Columns 1-6 -->
                            <!-- Tier 1, Role 1, Trait 4 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role1trait4">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 1, Role 2, Trait 4 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role2trait4">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 1, Role 3, Trait 4 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier1role3trait4">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                        </div>
                    </div>
                    <div class="tier2tab">
                        <h1> Tier 2</h1>
                        <div class='tier-grid'>
                            <!-- Row 1, Columns 1-6 -->
                            <!-- Tier 2, Role 1, Trait 1 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role1trait1">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 2, Role 2, Trait 1 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role2trait1">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 2, Role 3, Trait 1 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role3trait1">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Row 2, Columns 1-6 -->
                            <!-- Tier 2, Role 1, Trait 2 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role1trait2">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 2, Role 2, Trait 2 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role2trait2">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 2, Role 3, Trait 2 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role3trait2">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Row 3, Columns 1-6 -->
                            <!-- Tier 2, Role 1, Trait 3 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role1trait3">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 2, Role 2, Trait 3 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role2trait3">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 2, Role 3, Trait 3 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role3trait3">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="trait_Brawn">Brawn</option>
                                        <option value="trait_Magic">Magic</option>
                                        <option value="trait_Mastery">Mastery</option>
                                        <option value="trait_Impact">Impact</option>
                                        <option value="trait_Resist">Resist</option>
                                        <option value="trait_Energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Row 4, Columns 1-6 -->
                            <!-- Tier 2, Role 1, Trait 4 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role1trait4">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 2, Role 2, Trait 4 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role2trait4">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 2, Role 3, Trait 4 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier2role3trait4">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                        </div>
                    </div>
                    <div class="tier3tab">
                        <h1> Tier 3</h1>
                        <div class='tier-grid'>
                            <!-- Row 1, Columns 1-6 -->
                            <!-- Tier 3, Role 1, Trait 1 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role1trait1">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 3, Role 2, Trait 1 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role2trait1">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 3, Role 3, Trait 1 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role3trait1">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Row 2, Columns 1-6 -->
                            <!-- Tier 3, Role 1, Trait 2 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role1trait2">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 3, Role 2, Trait 2 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role2trait2">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 3, Role 3, Trait 2 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role3trait2">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Row 3, Columns 1-6 -->
                            <!-- Tier 3, Role 1, Trait 3 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role1trait3">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 3, Role 2, Trait 3 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role2trait3">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 3, Role 3, Trait 3 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role3trait3">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="trait_Brawn">Brawn</option>
                                        <option value="trait_Magic">Magic</option>
                                        <option value="trait_Mastery">Mastery</option>
                                        <option value="trait_Impact">Impact</option>
                                        <option value="trait_Resist">Resist</option>
                                        <option value="trait_Energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Row 4, Columns 1-6 -->
                            <!-- Tier 3, Role 1, Trait 4 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role1trait4">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 3, Role 2, Trait 4 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role2trait4">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                            <!-- Tier 3, Role 3, Trait 4 -->
                            <span>
                                <span class='select-new-arrow'><select name="attr_tier3role3trait4">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="brawn">Brawn</option>
                                        <option value="magic">Magic</option>
                                        <option value="mastery">Mastery</option>
                                        <option value="impact">Impact</option>
                                        <option value="resist">Resist</option>
                                        <option value="energy">Energy</option>
                                    </select></span>
                            </span>
                            <span>
                                <input placeholder="Talent" type="text">
                            </span>
                        </div>
                    </div>
                </div>
                <!------------------------ WEAPONS -------------------------------------->
                <div class="weaponSheet">
                    <h1>Weapons</h1>
                    <fieldset class="repeating_weapons">
                        <div class="new-wpn-grid">
                            <span class="new-wpn-grid-name">
                                <input class="input-wpn-name" type="text" placeholder="Weapon Name" name="attr_wpn_name">
                            </span>
                            <span class="new-wpn-grid-select">
                                <span>
                                    <span class='select-new-arrow'><select class="select-wpn" name="attr_wpn_source">
                                            <option value="def" selected="selected">Source</option>
                                            <option value="might">Might</option>
                                            <option value="will">Will</option>
                                            <option value="technique">Technique</option>
                                        </select></span>
                                </span>
                                <span>
                                    <span class='select-new-arrow'><select class="select-wpn" name="attr_wpn_feature">
                                            <option value="def" selected="selected">Feature</option>
                                            <option value="power">Power</option>
                                            <option value="range">Range</option>
                                            <option value="defender">Defender</option>
                                            <option value="holdout">Holdout</option>
                                            <option value="versatile">Versatile</option>
                                            <option value="heavy">Heavy Arm</option>
                                            <option value="spell">Spell Focus</option>
                                            <option value="snipe">Snipe</option>
                                        </select></span>
                                </span>
                            </span>
                            <span class="new-wpn-grid-notes">
                                <textarea class="txt-wpn-notes" name="attr_wpn_notes" type="text" placeholder="Notes"></textarea>
                            </span>
                            <span class="new-wpn-grid-equip">
                                <button type="action" name="act_equip-weapon">EQUIP</button>
                            </span>
                        </div>
                    </fieldset>
                </div>
                <!------------------------ ARMOR -------------------------------------->
                <div class="armorSheet">
                    <h1>Armor</h1>
                    <div class='ar-info-grid'>
                        <span class='ar-info'>Armor affects HP and AP</span>
                        <span class='ar-info-hp'>Max HP = Vigor * Armor</span>
                        <span class='ar-info-ap'>Max AP = <div class='help-text'>Tier<span class='tooltip'>Level Tier is calculated as<br />[(PlayerLevel/8)(Rounded Down) + 1]</span></div> + Armor</span>
                        <span class='ar-col-HP'>HP</span>
                        <span class='ar-col-AP'>AP</span>
                        <span class='ar-info-lgt'>LIGHT</span>
                        <span class='ar-info-med'>MEDIUM</span>
                        <span class='ar-info-hvy'>HEAVY</span>
                        <span class='ar-info-lgt-hp'>*7</span>
                        <span class='ar-info-med-hp'>*10</span>
                        <span class='ar-info-hvy-hp'>*13</span>
                        <span class='ar-info-lgt-ap'>+3</span>
                        <span class='ar-info-med-ap'>+2</span>
                        <span class='ar-info-hvy-ap'>+1</span>
                    </div>
                    <fieldset class="repeating_armor">
                        <div class='new-ar-grid'>
                            <span class="new-ar-grid-name">
                                <input class="input-ar-name" type="text" placeholder="Armor Name" name="attr_ar_name">
                            </span>
                            <span class="new-ar-grid-select">
                                <span class='select-new-arrow'>
                                    <select name="attr_armor_type" class="select-wgt">
                                        <option value="def" selected="selected">Select</option>
                                        <option value="light">Light</option>
                                        <option value="medium">Medium</option>
                                        <option value="heavy">Heavy</option>
                                    </select>
                                </span>
                            </span>
                            <span class="new-ar-grid-notes">
                                <textarea class="txt-ar-notes" name="attr_ar_notes" type="text" placeholder="Notes"></textarea>
                            </span>
                            <span class="new-ar-grid-equip">
                                <button type="action" name="act_equip-armor">EQUIP</button>
                            </span>
                        </div>
                    </fieldset>
                </div>
                <!----------------------- INVENTORY ------------------------------------->
                <div class="inventorySheet">
                    <h1>Inventory Coming Soon</h1>
                </div>
                <!----------------------- Skills ------------------------------------->
                <div class="skillSheet">
                    <h1>Skills Coming Soon</h1>
                </div>
            </span>
        </div>
    </span>
</span>

<rolltemplate class="sheet-rolltemplate-attack">
    <div class="sheet-outer-container">
    <div class="sheet-box-outer"><div class="sheet-box-middle"><div class="sheet-box-inner">
    <div class="sheet-template-container-attack">
        <div class="sheet-template-title">{{name}}</div>
        <div class="sheet-template-baseDice">Dice Rolled: {{base}} </div>
        <div class="sheet-template-diceMod">Dice Mod: {{diceMod}} </div>
        <div class="sheet-template-power">Weapon Power: {{wpnPower}} </div>
        <div class="sheet-template-powerMod">Power Mod: {{powerMod}} </div>
        <div class="sheet-template-tier">Tier: {{levelTier}} </div>
        <div class="sheet-template-result">Result: {{result}}</div>
    </div>
    </div></div></div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-stat">
    <div class="sheet-outer-container">
    <div class="sheet-box-outer"><div class="sheet-box-middle"><div class="sheet-box-inner">
    <div class="sheet-template-container-stat">
        <div class="sheet-template-title">{{name}} - {{statName}}</div>
        <div class="sheet-template-baseDice">Dice Rolled: {{base}} </div>
        <div class="sheet-template-diceMod">Dice Mod: {{diceMod}} </div>
        <div class="sheet-template-power">{{statName}} Value: {{statValue}} </div>
        <div class="sheet-template-powerMod">Power Mod: {{powerMod}} </div>
        <div class="sheet-template-tier">Tier: {{levelTier}} </div>
        <div class="sheet-template-result">Result: {{result}}</div>
    </div>
    </div></div></div>
    </div>
</rolltemplate>
<!------------------------------- SHEETWORKERS ----------------------------------------->
<script type="text/worker">
    /* ------------------------------------------ Page Toggle -------------------------------------------------------------*/

    const button_list = ["inventorySheet", "buildSheet", "weaponSheet", "armorSheet", "skillSheet"];

    const tier_list = ["tier1tab", "tier2tab", "tier3tab"];

    //Page Toggle
    button_list.forEach(button => {
       on('clicked:'+[button], function(){
          setAttrs({
                sheetTab: button
            });
       });
    });

    //Tier Tab Toggle
    tier_list.forEach(button => {
       on('clicked:'+[button], function(){
          setAttrs({
                tierTab: button
            });
       });
    });

    /* ------------------------------------------ Logic Variables -------------------------------------------------------------*/

    const tier1_trait_changes = [
        "change:tier1role1trait1",  "change:tier1role2trait1",  "change:tier1role3trait1",
        "change:tier1role1trait2",  "change:tier1role2trait2",  "change:tier1role3trait2",
        "change:tier1role1trait3",  "change:tier1role2trait3",  "change:tier1role3trait3",
        "change:tier1role1trait4",  "change:tier1role2trait4",  "change:tier1role3trait4"];

    const tier2_trait_changes = [
        "change:tier2role1trait1",  "change:tier2role2trait1",  "change:tier2role3trait1",
        "change:tier2role1trait2",  "change:tier2role2trait2",  "change:tier2role3trait2",
        "change:tier2role1trait3",  "change:tier2role2trait3",  "change:tier2role3trait3",
        "change:tier2role1trait4",  "change:tier2role2trait4",  "change:tier2role3trait4"];

    const tier3_trait_changes = [
        "change:tier3role1trait1",  "change:tier3role2trait1",  "change:tier3role3trait1",
        "change:tier3role1trait2",  "change:tier3role2trait2",  "change:tier3role3trait2",
        "change:tier3role1trait3",  "change:tier3role2trait3",  "change:tier3role3trait3",
        "change:tier3role1trait4",  "change:tier3role2trait4",  "change:tier3role3trait4"];
        
    const attributes = [
        "brawn",  "magic",      "mastery",    "impact",     "resist",
        "energy", "might",      "body",       "vigor",      "will",
        "ego",    "essence",    "technique",  "instinct",   "focus",
        "wpn_range", "wpn_block", "wpn_power",
        "armorhp_mod",  "armorap_mod",  "tier_mod",
        "hp_max",   "mp_max", "ap_max",
        "player_level", "player_level_mod"];

    var attribute_totals = {
        "brawn" :0, "magic"  :0, "mastery"  :0, "impact"  :0, "resist":0,
        "energy":0, "might"  :0, "body"     :0, "vigor"   :0, "will"  :0,
        "ego"   :0, "essence":0, "technique":0, "instinct":0, "focus" :0,
        "wpn_range" :0, "wpn_block" :0, "wpn_power": 0,
        "armorhp_mod" : 0,"armorap_mod" : 0, "tier_mod": 0,
        "hp_max": 0,      "mp_max": 0,      "ap_max": 0,
        "player_level": 0, "player_level_mod" :0};
        
    const currentPoints = ["hp", "mp", "ap"];
    const maxPoints = ["hp_max", "mp_max", "ap_max"];

    var equippedWeapon={
        source: "",
        feature: ""
    };

    var equippedArmorWgt = "none";

    const wpnFeatBonus={
        power:      {bonus: 1,  range: 0,   block: 0,  dice_mod: 0},
        range:      {bonus: 0,  range: 2,   block: 0,  dice_mod: 0},
        defender:   {bonus: 0,  range: 0,   block: 4,  dice_mod: 0},
        holdout:    {bonus: 0,  range: 1,   block: 2,  dice_mod: 0},
        versatile:  {bonus: 0,  range: 1,   block: 0,  dice_mod: 0},
        heavy:      {bonus: 3,  range: 0,   block: 0,  dice_mod: -1},
        spell:      {bonus: 1,  range: 2,   block: 0,  dice_mod: 0},
        snipe:      {bonus: 1,  range: 3,   block: 0,  dice_mod: -1}
    };

    //Read Attributes on Page Load
    on('sheet:opened', function(){
        
        attributes.forEach(function(attr){
            
            getAttrs([attr], function(values){
                
                attribute_totals[attr] = parseInt(values[attr]);
                //Set Attributes back (get written as Ints?)
                setAttrs({
                   [attr] : attribute_totals[attr]
                });

            });
            
        });
        
        getAttrs(["eq_wpn_source", "eq_wpn_feature", "eq_wpn_type"], function(values){
            var source = values["eq_wpn_source"].toLowerCase();
            var feature = values["eq_wpn_feature"].toLowerCase();
            console.log("Reading Equipped Values...");
            console.log("Source: " + source);
            console.log("Feature: " + feature);
            equippedWeapon.source = source;
            equippedWeapon.feature = feature;
        });
    });

   

    /* -------------------------- Gear Management ------------------------------------*/
    on("change:repeating_weapons", function (e) { console.log("Adding Weapon"); });
    on("change:repeating_armor", function (e) { console.log("Adding Armor"); });

    on("remove:repeating_weapons", function (e) { console.log("Weapon Removed");});
    on("remove:repeating_armor", function (e) { console.log("Armor Removed");});

    on("clicked:repeating_weapons:equip-weapon", function(){
        
        getAttrs(["repeating_weapons_wpn_name", "repeating_weapons_wpn_source", "repeating_weapons_wpn_feature"], function(values){
            
            var wpnName = values["repeating_weapons_wpn_name"];
            var wpnSource = values["repeating_weapons_wpn_source"];
            var wpnFeature = values["repeating_weapons_wpn_feature"];

            //Do nothing if either dropdown is default
            if(wpnSource != "def" && wpnFeature != "def" && wpnName.length != 0){
                equippedWeapon.source = wpnSource;
                equippedWeapon.feature = wpnFeature;

                console.log("Equipped Weapon Changed: ");
                console.log("Name: " + wpnName);
                console.log("Source: " + equippedWeapon.source);
                console.log("Feature: " + equippedWeapon.feature);

                calculateWeaponBonuses();

                setAttrs({
                    eq_wpn_name: wpnName,
                    eq_wpn_source: capitalizeWord(wpnSource),
                    eq_wpn_feature: capitalizeWord(wpnFeature),
                    eq_wpn_range: attribute_totals["wpn_range"],
                    eq_wpn_block: attribute_totals["wpn_block"],
                    eq_wpn_power: attribute_totals["wpn_power"]
                });
            };
        });
    });

    on("clicked:repeating_armor:equip-armor", function(){
        
        getAttrs(["repeating_armor_ar_name", "repeating_armor_armor_type"], function(values){
            
            var arName = values["repeating_armor_ar_name"];
            var arWeight = values["repeating_armor_armor_type"];

            //Do nothing if no type was selected or name is null
            if(arWeight != "def" && arName.length != 0){

                console.log("Equipped Armor Changed: ");
                console.log("Name: " + arName);
                console.log("Weight: " + arWeight);

                equippedArmorWgt = arWeight;

                calculateArmorBonuses();
                updateAllAttributeTotals();

                setAttrs({
                    eq_ar_name: arName,
                    eq_ar_weight: arWeight
                });
            };
        });
    });

    
    /* -------------------- Level/Attribute Management ------------------------------*/

    on("change:start-stat1 change:start-stat2", function(eventInfo){
        var oldValue = eventInfo.previousValue;
        var newValue = eventInfo.newValue;
        updateAttributes(oldValue, newValue);
        
        getAttrs(["start-stat1", "start-stat2"], function(values){
            
            var trait1 = "None";
            switch(values["start-stat1"]){
                    case "brawn":     trait1 = "Brawn";    break;
                    case "magic":     trait1 = "Magic";    break;
                    case "mastery":   trait1 = "Mastery";  break;
                };
            
            var trait2 = "None";    
            switch(values["start-stat2"]){
                    case "impact":    trait2 = "Impact";  break;
                    case "resist":    trait2 = "Resist";  break;
                    case "energy":    trait2 = "Energy";  break;
                };
                
            setAttrs({
                startbonus1 : trait1,
                startbonus2 : trait2
            });
        });
    });

    //Tier 1 Tally
    on(tier1_trait_changes.join(" "), function(eventInfo){
        var oldTrait = eventInfo.previousValue;
        var newTrait = eventInfo.newValue;
        
        updateLevel(oldTrait, newTrait);
        updateAttributes(oldTrait, newTrait);
    });

    //Tier 2 Tally
    on(tier2_trait_changes.join(" "), function(eventInfo){
        var oldTrait = eventInfo.previousValue;
        var newTrait = eventInfo.newValue;
        
        updateLevel(oldTrait, newTrait);
        updateAttributes(oldTrait, newTrait);
    });

    //Tier 3 Tally
    on(tier3_trait_changes.join(" "), function(eventInfo){
        var oldTrait = eventInfo.previousValue;
        var newTrait = eventInfo.newValue;
        
        updateLevel(oldTrait, newTrait);
        updateAttributes(oldTrait, newTrait);
    });

    function updateLevel(oldTrait, newTrait){
        if (newTrait == "def") {
            attribute_totals["player_level"] > 0 ? attribute_totals["player_level"] -= 1 : attribute_totals["player_level"];
        } else if (oldTrait == "def"){
            attribute_totals["player_level"] += 1;
        }

        calculatePlayerLevelMod();
        calculateTierMod();
    }

    function updateAttributes(oldTrait, newTrait){
        
        if(oldTrait != "def"){
            console.log("-----------------Changing Old Trait--------------------");
            console.log("Trait: " + oldTrait);
            console.log("Current Value: " + attribute_totals[oldTrait]);
            attribute_totals[oldTrait] > 2 ? attribute_totals[oldTrait] -= 1 : attribute_totals[oldTrait];
            console.log("New Value: " + attribute_totals[oldTrait]);
            console.log("--------------------------------------------------------");
        }

        if (newTrait != "def") {
            console.log("-----------------Changing New Trait--------------------");
            console.log("Trait: " + newTrait);
            console.log("Current Value: " + attribute_totals[newTrait]);
            attribute_totals[newTrait] += 1;
            console.log("New Value: " + attribute_totals[newTrait]);
            console.log("--------------------------------------------------------");
        }
            
        
        updateOtherAttributes();
        calculatePointTotals();
        calculateWeaponBonuses();
        calculateArmorBonuses();
        
        updateAllAttributeTotals();
    }

    function updateOtherAttributes(){
        attribute_totals["might"]       =   attribute_totals["brawn"]   +   attribute_totals["impact"];
        attribute_totals["body"]        =   attribute_totals["brawn"]   +   attribute_totals["resist"];
        attribute_totals["vigor"]       =   attribute_totals["brawn"]   +   attribute_totals["energy"];
        attribute_totals["will"]        =   attribute_totals["magic"]   +   attribute_totals["impact"];
        attribute_totals["ego"]         =   attribute_totals["magic"]   +   attribute_totals["resist"];
        attribute_totals["essence"]     =   attribute_totals["magic"]   +   attribute_totals["energy"];
        attribute_totals["technique"]   =   attribute_totals["mastery"] +   attribute_totals["impact"];
        attribute_totals["instinct"]    =   attribute_totals["mastery"] +   attribute_totals["resist"];
        attribute_totals["focus"]       =   attribute_totals["mastery"] +   attribute_totals["energy"];
    };

    function updateAllAttributeTotals(){
        attributes.forEach(function(attr){
            setAttrs({
                   [attr] : attribute_totals[attr]
            });
        });
    }

    /* ------------------ Roller Modifier Logic ------------------------------------*/

    on("change:stat_roller_toggle", function(){
        console.log("Radio Button Change");
        getAttrs(["stat_roller_toggle", "stat_roll_dice_mod_ready"], function(values){
            calculateStatRoll(values.stat_roll_dice_mod_ready, values.stat_roller_toggle);
        });
    });

    //Verify Stat Roll modifier inputs
    on("change:stat_roll_dice_mod change:stat_roll_power_mod", function(){
        getAttrs(["stat_roll_dice_mod", "stat_roll_power_mod", "stat_roller_toggle"], function(values){
            console.log("--------------------------------");
            console.log("Stat Dice Mod Change Detected");

            var dice_mod = parseInt(values["stat_roll_dice_mod"]) || 0;
            var power_mod = parseInt(values["stat_roll_power_mod"]) || 0;
            var toggle = values["stat_roller_toggle"];

            console.log("Dice Mod: " + dice_mod);
            console.log("Stat Mod: " + power_mod);

            calculateStatRoll(dice_mod, toggle);

            setAttrs({
                stat_roll_dice_mod_ready : dice_mod,
                stat_roll_power_mod_ready : power_mod
            });
        });
    });

    //Verify Attack Roll modifier inputs
    on("change:atk_roll_dice_mod change:atk_roll_power_mod", function(){
        getAttrs(["atk_roll_dice_mod", "atk_roll_power_mod"], function(values){
            console.log("--------------------------------");
            console.log("Attack Dice Mod Change Detected");

            var dice_mod = parseInt(values.atk_roll_dice_mod) || 0;
            var power_mod = parseInt(values.atk_roll_power_mod) || 0;

            console.log("Dice Mod: " + dice_mod);
            console.log("Stat Mod: " + power_mod);

            calculateAttackBaseRoll(dice_mod);

            setAttrs({
                atk_roll_dice_mod_ready : dice_mod,
                atk_roll_power_mod_ready : power_mod
            });
        });
    });

    /* ------------------ Formula Calculations ----------------------------------*/    

    function calculateArmorBonuses(){
        var hp_mod = 0;
        var ap_mod = 0;
        console.log("Reading Weight: " + equippedArmorWgt);
        switch(equippedArmorWgt){
             case "none":   hp_mod = 0;     ap_mod = 0; break;
             case "light":  hp_mod = 7;     ap_mod = 3; break;
             case "medium": hp_mod = 10;    ap_mod = 2; break;
             case "heavy":  hp_mod = 13;    ap_mod = 1; break;
           };

        console.log("HP: " + hp_mod);
        console.log("AP: " + ap_mod);

        attribute_totals["armorhp_mod"] = hp_mod;
        attribute_totals["armorap_mod"] = ap_mod;

        calculatePointTotals();
           
           setAttrs({
               armorhp_mod : hp_mod,
               armorap_mod : ap_mod
           });
    }

    function calculateWeaponBonuses(){
        if(!["None", "def"].includes(equippedWeapon.source) && !["None", "def"].includes(equippedWeapon.feature)){
            
            var bonus = equippedWeapon.source == "might" ? 
                                            1 + wpnFeatBonus[equippedWeapon.feature].bonus: 
                                            wpnFeatBonus[equippedWeapon.feature].bonus;
                                            
            attribute_totals["wpn_range"] = 1 + wpnFeatBonus[equippedWeapon.feature].range;
            
            attribute_totals["wpn_block"] = wpnFeatBonus[equippedWeapon.feature].block * attribute_totals["tier_mod"];
            
            attribute_totals["wpn_power"] = attribute_totals[equippedWeapon.source] + 
                                        (attribute_totals["tier_mod"] * bonus);
                                        
            getAttrs(["stat_roll_dice_mod_ready"], function(values){
                calculateAttackBaseRoll(values["stat_roll_dice_mod_ready"]);
            });
        }
    };

    /* Recalculate Base Rolls */

    function calculateAttackBaseRoll(playerModDie){
        var base_attack;
        console.log("--------------Recalculating Attack Roll----------------");
        var diceMod = wpnFeatBonus[equippedWeapon.feature].dice_mod + playerModDie;

        console.log("Dice Mod: " + diceMod);

        if(diceMod < 0){
            base_attack = (Math.abs(diceMod) + 3) + "d20>8kl3";
        } else{
            base_attack = (diceMod + 3) + "d20>8";
        }   

        console.log("Base Attack is: " + base_attack);

        setAttrs({
            atk_base_dice_roll : base_attack,
            atk_roll_tier : attribute_totals["tier_mod"]
        });
    };

    function calculateStatRoll(diceMod, toggle){
        var base_roll = (Math.abs(diceMod) + 3) + "d20";
        var operator;
        var power_formula;
        var type;

        if(toggle == "attack"){
            if(diceMod < 0){
                base_roll = base_roll.concat(">8kl3");
            } else {
                base_roll = base_roll.concat(">8");
            }
            operator = "*";
            power_formula = "(@{stat_roll_power_mod_ready} * " + attribute_totals["tier_mod"] + ")";
            type = "Success-Based";
        } else {
            if(diceMod < 0){
                base_roll = base_roll.concat("kl3");
            } else {
                base_roll = base_roll.concat("k3");
            }
            operator = "+";
            power_formula = "@{stat_roll_power_mod_ready}";
            type = "Additive";
        }

        console.log("Type is: " + type);
        console.log("Base Roll is: " + base_roll);
        console.log("Base Operator is: " + operator);
        console.log("PowerMod is: " + power_formula);

        setAttrs({
            stat_base_dice_roll : base_roll,
            stat_roll_operator : operator,
            stat_roll_type : type,
            stat_roll_power_formula : power_formula
        });

    }

    function calculateTierMod(){
        attribute_totals["tier_mod"] = Math.floor((attribute_totals["player_level"]/8) + 1);
    };

    function calculatePlayerLevelMod(){
        var level = attribute_totals["player_level"];
        switch(true){
                case level < 8:   attribute_totals["player_level_mod"] = 1; break;
                case level < 16:  attribute_totals["player_level_mod"] = 2; break;
                case level < 24:  attribute_totals["player_level_mod"] = 3; break;
                case level > 23:  attribute_totals["player_level_mod"] = 4; break;
            }
    };

    function calculatePointTotals(){
        attribute_totals["hp_max"] = attribute_totals["armorhp_mod"] * attribute_totals["vigor"];
        attribute_totals["mp_max"] = attribute_totals["essence"] * 2;
        attribute_totals["ap_max"] = (attribute_totals["armorap_mod"] * attribute_totals["tier_mod"]) + attribute_totals["focus"];
    };

    function capitalizeWord(string) {
      return string.charAt(0).toUpperCase() + string.slice(1);
    }
</script>